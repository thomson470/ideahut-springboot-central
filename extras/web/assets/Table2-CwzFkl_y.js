const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-BM65YuFT.js","assets/format-BYB7LI8Y.js","assets/index-3Ds9K3sY.js","assets/index-DH4Oj3ZA.css","assets/QTooltip-DTsmNrTK.js","assets/QTabPanels-Dth9Sind.js","assets/QResizeObserver-BXkVA_nK.js","assets/QSelect-ybIcc9Im.js","assets/touch-BjYP5sR0.js","assets/QPopupProxy-C3yyw3d7.js","assets/TouchPan-CDLsl8kT.js","assets/QForm-DrU6uDMp.js","assets/ClosePopup-Cf-fI5V5.js","assets/View2-DFLH3AkQ.js","assets/Index-DuSzNtU_.js","assets/QSpace-CAwOBfmg.js","assets/QTable-B2WsSpTs.js","assets/QList-CSjzfvcx.js","assets/QInnerLoading-7DJ72R4W.js","assets/Edit2-CfUjQd_z.js","assets/QFab-xgpS96yX.js"])))=>i.map(i=>d[i]);
import{_ as U,ai as w,an as y,$ as O,Y as b,r as g,a2 as k,a3 as s,aa as x,f as t,a4 as o,al as q,a6 as V,a7 as u,a5 as c,a1 as m,F as C,ab as E,aj as h,a8 as p,E as I,as as Q,ah as N,at as z,am as D,ak as v}from"./index-3Ds9K3sY.js";import{Q as G,b as R,a as L}from"./format-BYB7LI8Y.js";import{Q as T}from"./QTooltip-DTsmNrTK.js";import{b as B}from"./QSelect-ybIcc9Im.js";import{Q as A}from"./QSpace-CAwOBfmg.js";import{Q as F,a as Y}from"./QTable-B2WsSpTs.js";import{Q as H}from"./QInnerLoading-7DJ72R4W.js";import{g as r}from"./Index-DuSzNtU_.js";import"./QList-CSjzfvcx.js";const J={props:["parameters"],emits:["close"],components:{Search:w(()=>y(()=>import("./Search-BM65YuFT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),View2:w(()=>y(()=>import("./View2-DFLH3AkQ.js"),__vite__mapDeps([13,1,2,3,4,12,14,15,7,16,17,18]))),Edit2:w(()=>y(()=>import("./Edit2-CfUjQd_z.js"),__vite__mapDeps([19,2,3,1,4,7,5,6,8,9,10,20,12,14,15,16,17,18])))},setup(){return{uix:O,util:b,fxGrid:r,template:g({}),definition:g({}),permission:g({}),parentRow:g({}),relations:g([]),onlyView:g(!1),replica:g(null),labels:g([]),chips:["red-10","deep-purple-10","light-blue-10","brown-10","deep-orange-10","blue-grey-10"],dialog:g({search:{show:!1,parameters:null},view:{show:!1,parameters:null},edit:{show:!1,parameters:null}}),search:g({filters:[],empty:!0}),table:g({rows:[],columns:[],visibles:[],selected:[],pagination:{},loading:!1,deleting:!1,separator:"none"})}},created(){let i=this,l=r.get.object(i.parameters);i.template=r.get.object(l.template),i.definition=r.get.object(l.definition),i.parentRow=r.get.object(l.parentRow),i.relations=r.get.array(l.relations),i.replica=r.get.number(l.replica,null),i.onlyView=l.onlyView===!0,i.permission={actions:r.copy(i.template.actions)};let d=i.definition?.action?.exclude?i.definition.action.exclude:[];if(i.permission.actions=i.template.actions.filter(e=>!d.includes(e)),i.search={empty:!0,filters:r.copy(r.get.array(i.definition.table.filters))},i.table={rows:[],columns:i.definition.table.columns,visibles:i.definition.table.visibles,selected:[],pagination:{page:1,rowsPerPage:i.definition.table.page.default,sortBy:i.definition.table.order.field,descending:i.definition.table.order.descending===!0},loading:!1,deleting:!1,separator:b.isString(i.definition.table.separator)?i.definition.table.separator:"none"},i.labels=[],b.isArray(i.definition.labels))for(const e of i.definition.labels){let _=r.copy(e);b.isString(_.value)&&(_.value=b.getFieldValue(_.value,i.parentRow),i.labels.push(_))}i.do_request({pagination:i.table.pagination})},methods:{do_request(i){let l=this;r.action.page({props:i,table:l.table,search:l.search,definition:l.definition,replica:l.replica,relations:l.relations,allUseSameReplica:l.template.allUseSameReplica})},on_close_click(){this.$emit("close")},on_refresh_click(){let i=this;i.do_request({pagination:i.table.pagination})},on_delete_click(i){let l=this;r.action.delete({row:i.row,definition:l.definition,table:l.table,deleting:l.deleting,replica:l.replica,onSuccess:function(){l.do_request({pagination:l.table.pagination})}})},on_search_click(){let i=this,l=i.dialog.search;l.parameters={filters:r.copy(i.search.filters),template:i.template},l.show=!0},on_close_dialog_search(i){let l=this;if(b.isArray(i)){let d=l.search,e,_;d.filters=i,d.empty=!0;for(const n of d.filters)if(e=b.isDefined(n.value)?n.value:"",_=b.isDefined(n.value2)?n.value2:"",e!==""||_!==""){d.empty=!1;break}l.dialog.search={show:!1,parameters:null},l.table.pagination.page=1,l.do_request({pagination:l.table.pagination})}},on_view_click(i){let l=this;l.dialog.view={show:!0,parameters:{parentRow:l.parentRow,row:i.row,template:l.template,replica:l.replica,definition:l.definition}}},on_edit_click(i){let l=this;l.dialog.edit={show:!0,parameters:{parentRow:l.parentRow,row:i.row,template:l.template,replica:l.replica,definition:l.definition,index:i.rowIndex,relations:l.relations}}},on_add_click(){let i=this;i.dialog.edit={show:!0,parameters:{parentRow:i.parentRow,template:i.template,replica:i.replica,definition:i.definition,relations:i.relations}}},on_close_dialog_edit(i){let l=this,d=i.row;if(d)if(i.is_edit)if(b.isDefined(d._pk_))l.table.rows[i.index]=d;else{l.dialog.edit={show:!1,parameters:null},setTimeout(function(){l.dialog.edit={show:!0,parameters:{row:d,parentRow:l.parentRow,template:l.template,replica:l.replica,definition:l.definition,relations:l.relations}}},100);return}else l.do_request({pagination:l.table.pagination});l.dialog.edit={show:!1,parameters:null}},on_page_changed(){let i=this,l=+i.table.pagination.page;!isNaN(l)&&l>0&&i.do_request({pagination:i.table.pagination})}}},K={class:"q-ml-sm"},M={class:"full-width row flex-center text-accent q-gutter-sm"},W={class:"text-subtitle2"},X={key:0,class:"text-left"},Z={class:"text-caption"};function $(i,l,d,e,_,n){const j=k("Search"),P=k("View2"),S=k("Edit2");return s(),x(C,null,[t(D,{class:"background-layout",style:{"min-width":"60vw","max-width":"90vw"}},{default:o(()=>[t(q,{class:"q-pa-none header-main"},{default:o(()=>[t(G,{class:"q-pr-none"},{default:o(()=>[t(R,null,{default:o(()=>[t(L,{class:"text-h6 text-white"},{default:o(()=>[V(u(e.template.title+" - "+e.definition.title),1)]),_:1})]),_:1}),t(R,{side:""},{default:o(()=>[t(c,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close",onClick:n.on_close_click},{default:o(()=>[t(T,null,{default:o(()=>[V(u(i.$t("label.close")),1)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),e.labels?.length?(s(),m(q,{key:0,class:"q-pa-sm q-mt-xs"},{default:o(()=>[(s(!0),x(C,null,E(e.labels,(a,f)=>(s(),m(B,{key:f,color:e.chips[f%e.chips.length],"text-color":"white",class:"ellipsis-text"},{default:o(()=>[h("strong",null,[h("span",null,u(a.title)+":",1)]),h("span",K,u(a.value),1)]),_:2},1032,["color"]))),128))]),_:1})):p("",!0),t(q,{style:{"max-height":"80vh","overflow-y":"scroll !important"},class:"q-pa-xs"},{default:o(()=>[t(F,{class:"table-sticky-header q-ma-sm",rows:e.table.rows,columns:e.table.columns,"visible-columns":e.table.visibles,"row-key":"_pk_",loading:e.table.loading,selection:e.util.isObject(e.definition.table)?e.definition.table.selection:"single",selected:e.table.selected,"onUpdate:selected":l[1]||(l[1]=a=>e.table.selected=a),pagination:e.table.pagination,"onUpdate:pagination":l[2]||(l[2]=a=>e.table.pagination=a),dense:i.$q.screen.lt.md,"no-data-label":i.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":a=>{},"rows-per-page-options":e.util.isObject(e.definition.table)&&e.definition.table.page?.options?e.definition.table.page.options:[10,20,30],onRequest:n.do_request,"binary-state-sort":"",separator:e.util.isObject(e.definition.table)?e.definition.table.separator:"cell",bordered:"",style:{"max-height":"72vh"}},{top:o(()=>[e.util.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.fxGrid.permission.deletes(e.permission)&&!e.onlyView?(s(),m(c,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"negative",icon:"delete",disable:!e.table.selected.length,loading:e.table.deleting,onClick:n.on_delete_click},null,8,["disable","loading","onClick"])):p("",!0),e.fxGrid.permission.add(e.permission)&&!e.onlyView?(s(),m(c,{key:1,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"teal",icon:"add",onClick:n.on_add_click},null,8,["onClick"])):p("",!0),t(A),e.search.filters?.length?(s(),m(c,{key:2,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:n.on_search_click},{default:o(()=>[e.search.empty?p("",!0):(s(),m(Y,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):p("",!0),t(c,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:e.table.loading,onClick:n.on_refresh_click},null,8,["loading","onClick"])]),"no-data":o(({message:a})=>[h("div",M,[t(I,{size:"2em",name:"block"}),h("span",W,u(a),1)])]),loading:o(()=>[t(H,{showing:"",color:"primary"})]),"header-selection":o(a=>[e.util.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.fxGrid.permission.deletes(e.permission)&&!e.onlyView?(s(),x("div",X,[t(Q,{dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:a.selected,"onUpdate:modelValue":f=>a.selected=f},null,8,["modelValue","onUpdate:modelValue"])])):p("",!0)]),"body-selection":o(a=>[e.util.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.fxGrid.permission.deletes(e.permission)&&!e.onlyView?(s(),m(Q,{key:0,dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:a.selected,"onUpdate:modelValue":f=>a.selected=f},null,8,["modelValue","onUpdate:modelValue"])):e.util.isObject(e.definition.table)&&e.fxGrid.permission.delete(e.permission)&&!e.onlyView?(s(),m(c,{key:1,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"negative",icon:"delete",onClick:f=>n.on_delete_click(a)},null,8,["onClick"])):p("",!0),e.fxGrid.permission.edit(e.permission)&&!e.onlyView?(s(),m(c,{key:2,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"primary",icon:"drive_file_rename_outline",onClick:f=>n.on_edit_click(a)},null,8,["onClick"])):p("",!0),e.fxGrid.permission.view(e.permission)?(s(),m(c,{key:3,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"deep-purple",icon:"visibility",onClick:f=>n.on_view_click(a)},null,8,["onClick"])):p("",!0)]),pagination:o(a=>[a.pagesNumber>2?(s(),m(c,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:a.isFirstPage,onClick:a.firstPage},null,8,["disable","onClick"])):p("",!0),t(c,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:a.isFirstPage,onClick:a.prevPage},null,8,["disable","onClick"]),t(N,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:e.table.pagination.page,"onUpdate:modelValue":[l[0]||(l[0]=f=>e.table.pagination.page=f),n.on_page_changed]},z({_:2},[e.util.isObject(e.definition.table)&&e.util.isObject(e.definition.table.page)&&e.definition.table.page.count===!0?{name:"append",fn:o(()=>[h("span",Z," / "+u(a.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),t(c,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:a.isLastPage,onClick:a.nextPage},null,8,["disable","onClick"]),a.pagesNumber>2?(s(),m(c,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:a.isLastPage,onClick:a.lastPage},null,8,["disable","onClick"])):p("",!0)]),_:1},8,["rows","columns","visible-columns","loading","selection","selected","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1})]),_:1}),t(v,{modelValue:e.dialog.search.show,"onUpdate:modelValue":l[3]||(l[3]=a=>e.dialog.search.show=a),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(2px)"},{default:o(()=>[t(j,{parameters:e.dialog.search.parameters,onClose:n.on_close_dialog_search},null,8,["parameters","onClose"])]),_:1},8,["modelValue"]),t(v,{modelValue:e.dialog.view.show,"onUpdate:modelValue":l[4]||(l[4]=a=>e.dialog.view.show=a),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(2px)"},{default:o(()=>[t(P,{parameters:e.dialog.view.parameters},null,8,["parameters"])]),_:1},8,["modelValue"]),t(v,{modelValue:e.dialog.edit.show,"onUpdate:modelValue":l[5]||(l[5]=a=>e.dialog.edit.show=a),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(2px)"},{default:o(()=>[t(S,{parameters:e.dialog.edit.parameters,onClose:n.on_close_dialog_edit},null,8,["parameters","onClose"])]),_:1},8,["modelValue"])],64)}const de=U(J,[["render",$]]);export{de as default};
