const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-CdlHL2ap.js","assets/format-DSJ2X3bs.js","assets/index-P44lIENJ.js","assets/index-CWourn4h.css","assets/QTooltip-9usYVsV3.js","assets/QTabPanels-BW9KjBRm.js","assets/QResizeObserver-CK2XwMh2.js","assets/QSelect-CS6ORECd.js","assets/QPopupProxy-3l76UF6Q.js","assets/TouchPan-CvehtYGM.js","assets/QForm-DBmEgZ47.js","assets/ClosePopup-dgko-JG3.js"])))=>i.map(i=>d[i]);
import{_ as S,al as N,ap as j,Y as D,Z as f,r as c,a0 as u,a3 as A,a4 as d,ac as B,f as l,a5 as i,C as _,a2 as p,an as x,ab as w,a7 as q,a8 as h,a6 as r,aa as k,ae as b,G as I,bw as z,ak as T,av as L,Q as O,aK as R,ao as U,am as F,F as E}from"./index-P44lIENJ.js";import{Q as G,b as C,a as K}from"./format-DSJ2X3bs.js";import{Q as Y}from"./QTooltip-9usYVsV3.js";import{Q as Z}from"./QSpace-CirYgUHy.js";import{a as H}from"./QList-Bzhuo3b5.js";import{Q as J}from"./QInnerLoading-E0vqNTz4.js";import{Q as M}from"./QTable-yqnelvyL.js";import{C as Q}from"./ClosePopup-dgko-JG3.js";import{T as P}from"./TouchPan-CvehtYGM.js";import{g as n}from"./Index-09v2zuFp.js";import"./QSelect-CS6ORECd.js";let e;const W={props:["parameters"],emits:["close"],components:{Search:N(()=>j(()=>import("./Search-CdlHL2ap.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])))},setup(){return{APP:D,util:f,template:c({}),field:c({}),pick:c({}),relations:c([]),replica:c(null),table:c({rows:[],columns:[],visibles:[],selected:null,pagination:{},loading:!1}),search:c({filters:[],empty:!0}),dialog:c({main:u.dialog.init(()=>e.dialog.main),search:u.dialog.init(()=>e.dialog.search)})}},created(){e=this;let t=n.get.object(e.parameters);e.template=n.get.object(t.template),e.replica=n.get.number(t.replica,null),e.field=n.get.object(t.field),e.relations=n.get.array(t.relations),e.pick=n.get.object(t.pick),e.pick._grid_id_=e.template._grid_id_,e.search={empty:!0,filters:n.copy(n.get.array(e.pick.table.filters))},e.table={rows:[],columns:e.pick.table.columns,visibles:e.pick.table.visibles,selected:null,pagination:{page:1,rowsPerPage:e.pick.table.page.default,sortBy:e.pick.table.order.field,descending:e.pick.table.order.descending===!0},loading:!1},e.do_request({pagination:e.table.pagination})},methods:{do_request(t){n.action.page({props:t,table:e.table,search:e.search,definition:e.pick,relations:e.relations,replica:e.pick.enableReplica===!0?e.replica:null})},on_refresh_click(){e.do_request({pagination:e.table.pagination})},on_select_click(){e.$emit("close",e.table.selected)},on_search_click(){u.dialog.show(e.dialog.search,{filters:n.copy(e.search.filters),template:e.template})},on_close_dialog_search(t){if(f.isArray(t)){let s=e.search,y,a;s.filters=t,s.empty=!0;for(const m of s.filters)if(y=f.isDefined(m.value)?m.value:"",a=f.isDefined(m.value2)?m.value2:"",y!==""||a!==""){s.empty=!1;break}u.dialog.hide(e.dialog.search),e.table.pagination.page=1,e.do_request({pagination:e.table.pagination})}},on_page_changed(){let t=+e.table.pagination.page;!isNaN(t)&&t>0&&e.do_request({pagination:e.table.pagination})}}},X={class:"full-width row flex-center text-accent q-gutter-sm"},$={class:"text-subtitle2"},ee={class:"text-caption"},ae={class:"col-6 q-pr-xs text-left"},le={class:"col-6 q-pl-xs text-right"};function oe(t,s,y,a,m,g){const V=A("Search");return d(),B(E,null,[l(U,{style:w("min-width: 60vw; max-width: 90vw; max-height: 90vh;"+a.dialog.main.style)},{default:i(()=>[_((d(),p(x,{class:"q-pa-none header-main",style:w(a.APP?.color?.header?"background: "+a.APP.color.header+" !important;":"")},{default:i(()=>[l(G,{class:"q-pr-none"},{default:i(()=>[l(C,null,{default:i(()=>[l(K,{class:"text-h6 text-white"},{default:i(()=>[q(h(a.pick.title),1)]),_:1})]),_:1}),l(C,{side:""},{default:i(()=>[_((d(),p(r,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close"},{default:i(()=>[l(Y,null,{default:i(()=>[q(h(t.$t("label.close")),1)]),_:1})]),_:1})),[[Q]])]),_:1})]),_:1})]),_:1},8,["style"])),[[P,a.dialog.main.onDrag,void 0,{mouse:!0}]]),l(x,{style:{"max-height":"80vh"},class:"q-pa-xs q-pt-sm scroll"},{default:i(()=>[l(M,{class:"table-sticky-header q-ma-none",rows:a.table.rows,columns:a.table.columns,"visible-columns":a.table.visibles,"row-key":"_pk_",loading:a.table.loading,selection:"single",pagination:a.table.pagination,"onUpdate:pagination":s[2]||(s[2]=o=>a.table.pagination=o),dense:t.$q.screen.lt.md,"no-data-label":t.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":o=>{},"rows-per-page-options":a.util.isObject(a.pick.table)&&a.pick.table.page?.options?a.pick.table.page.options:[10,20,30],onRequest:g.do_request,"binary-state-sort":"",separator:a.util.isObject(a.pick.table)?a.pick.table.separator:"cell",bordered:"",style:{"max-height":"70vh"}},{top:i(()=>[l(Z),a.search.filters&&a.search.filters.length?(d(),p(r,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:g.on_search_click},{default:i(()=>[a.search.empty?k("",!0):(d(),p(H,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):k("",!0),l(r,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:a.table.loading,onClick:g.on_refresh_click},null,8,["loading","onClick"])]),"no-data":i(({message:o})=>[b("div",X,[l(I,{size:"2em",name:"block"}),b("span",$,h(o),1)])]),loading:i(()=>[l(J,{showing:"",color:"primary"})]),"body-selection":i(o=>[l(z,{modelValue:a.table.selected,"onUpdate:modelValue":s[0]||(s[0]=v=>a.table.selected=v),val:o.row,color:"primary"},null,8,["modelValue","val"])]),pagination:i(o=>[o.pagesNumber>2?(d(),p(r,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:o.isFirstPage,onClick:o.firstPage},null,8,["disable","onClick"])):k("",!0),l(r,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:o.isFirstPage,onClick:o.prevPage},null,8,["disable","onClick"]),l(T,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:a.table.pagination.page,"onUpdate:modelValue":[s[1]||(s[1]=v=>a.table.pagination.page=v),g.on_page_changed]},L({_:2},[a.util.isObject(a.pick.table)&&a.util.isObject(a.pick.table.page)&&a.pick.table.page.count===!0?{name:"append",fn:i(()=>[b("span",ee," / "+h(o.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),l(r,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:o.isLastPage,onClick:o.nextPage},null,8,["disable","onClick"]),o.pagesNumber>2?(d(),p(r,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:o.isLastPage,onClick:o.lastPage},null,8,["disable","onClick"])):k("",!0)]),_:1},8,["rows","columns","visible-columns","loading","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1}),l(O),l(R,{class:"row"},{default:i(()=>[b("div",ae,[_(l(r,{label:t.$t("label.cancel"),color:"negative","no-caps":"",glossy:""},null,8,["label"]),[[Q]])]),b("div",le,[l(r,{label:t.$t("label.select"),color:"indigo","no-caps":"",glossy:"",disable:!a.table.selected?._pk_,onClick:g.on_select_click},null,8,["label","disable","onClick"])])]),_:1})]),_:1},8,["style"]),l(F,{modelValue:a.dialog.search.show,"onUpdate:modelValue":s[3]||(s[3]=o=>a.dialog.search.show=o),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:i(()=>[_(l(V,{parameters:a.dialog.search.parameters,onClose:g.on_close_dialog_search,style:w(a.dialog.search.style)},null,8,["parameters","onClose","style"]),[[P,a.dialog.search.onDrag,void 0,{mouse:!0}]])]),_:1},8,["modelValue"])],64)}const fe=S(W,[["render",oe]]);export{fe as default};
