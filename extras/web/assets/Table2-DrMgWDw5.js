const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-D3_PtVdq.js","assets/format-0B3yNPe0.js","assets/index-CZ6M6r4H.js","assets/index-CWourn4h.css","assets/QTooltip-DjcLDuxo.js","assets/QTabPanels-7HKSbxKx.js","assets/QResizeObserver-PNlafFmi.js","assets/QSelect-C94E7tUG.js","assets/QPopupProxy-Bi75XexN.js","assets/TouchPan-DwFn1rMB.js","assets/QForm-CC1IWNRa.js","assets/ClosePopup-ClacVTk0.js","assets/View2-COIN0mkJ.js","assets/Index-DhrOtw8O.js","assets/QSpace-CwLm70lj.js","assets/QList-BiKbVLpI.js","assets/QInnerLoading-C0Qo2eI0.js","assets/QTable-Djq8-VFi.js","assets/Edit2-wf9cnLyB.js","assets/QFab-BrBMhDWh.js"])))=>i.map(i=>d[i]);
import{_ as T,al as k,ap as v,Y as z,a0 as d,Z as _,r as p,a3 as x,a4 as s,ac as q,f as n,a5 as t,C as Q,a2 as c,an as V,ab as C,a7 as R,a8 as w,a6 as g,F as j,ad as A,ae as h,a9 as b,G,au as O,ak as N,av as L,ao as B,am as P}from"./index-CZ6M6r4H.js";import{Q as F,b as S,a as Y}from"./format-0B3yNPe0.js";import{Q as Z}from"./QTooltip-DjcLDuxo.js";import{b as H}from"./QSelect-C94E7tUG.js";import{Q as J}from"./QSpace-CwLm70lj.js";import{a as K}from"./QList-BiKbVLpI.js";import{Q as M}from"./QInnerLoading-C0Qo2eI0.js";import{Q as W}from"./QTable-Djq8-VFi.js";import{T as D}from"./TouchPan-DwFn1rMB.js";import{g as r}from"./Index-DhrOtw8O.js";let i;const X={props:["parameters"],emits:["close"],components:{Search:k(()=>v(()=>import("./Search-D3_PtVdq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),View2:k(()=>v(()=>import("./View2-COIN0mkJ.js"),__vite__mapDeps([12,1,2,3,4,11,9,13,14,7,15,16,17]))),Edit2:k(()=>v(()=>import("./Edit2-wf9cnLyB.js"),__vite__mapDeps([18,2,3,1,4,7,5,6,8,9,19,11,13,14,15,16,17])))},setup(){return{APP:z,uix:d,util:_,fxGrid:r,template:p({}),definition:p({}),permission:p({}),parentRow:p({}),relations:p([]),onlyView:p(!1),replica:p(null),labels:p([]),chips:["red-10","deep-purple-10","light-blue-10","brown-10","deep-orange-10","blue-grey-10"],dialog:p({main:d.dialog.init(()=>i.dialog.main),search:d.dialog.init(()=>i.dialog.search),view:d.dialog.init(),edit:d.dialog.init()}),search:p({filters:[],empty:!0}),table:p({rows:[],columns:[],visibles:[],selected:[],pagination:{},loading:!1,deleting:!1,separator:"none"})}},created(){i=this;let a=r.get.object(i.parameters);i.template=r.get.object(a.template),i.definition=r.get.object(a.definition),i.parentRow=r.get.object(a.parentRow),i.relations=r.get.array(a.relations),i.replica=r.get.number(a.replica,null),i.onlyView=a.onlyView===!0,i.permission={actions:r.copy(i.template.actions)};let o=i.definition?.action?.exclude?i.definition.action.exclude:[];if(i.permission.actions=i.template.actions.filter(u=>!o.includes(u)),i.search={empty:!0,filters:r.copy(r.get.array(i.definition.table.filters))},i.table={rows:[],columns:i.definition.table.columns,visibles:i.definition.table.visibles,selected:[],pagination:{page:1,rowsPerPage:i.definition.table.page.default,sortBy:i.definition.table.order.field,descending:i.definition.table.order.descending===!0},loading:!1,deleting:!1,separator:_.isString(i.definition.table.separator)?i.definition.table.separator:"none"},i.labels=[],_.isArray(i.definition.labels))for(const u of i.definition.labels){let e=r.copy(u);_.isString(e.value)&&(e.value=_.getFieldValue(e.value,i.parentRow),i.labels.push(e))}i.do_request({pagination:i.table.pagination})},methods:{do_request(a){r.action.page({props:a,table:i.table,search:i.search,definition:i.definition,replica:i.definition.enableReplica===!0?i.replica:null,relations:i.relations})},on_close_click(){i.$emit("close")},on_refresh_click(){i.do_request({pagination:i.table.pagination})},on_delete_click(a){r.action.delete({row:a.row,definition:i.definition,table:i.table,deleting:i.deleting,replica:i.replica,onSuccess:function(){i.do_request({pagination:i.table.pagination})}})},on_search_click(){d.dialog.show(i.dialog.search,{filters:r.copy(i.search.filters),template:i.template})},on_close_dialog_search(a){if(_.isArray(a)){let o=i.search,u,e;o.filters=a,o.empty=!0;for(const y of o.filters)if(u=_.isDefined(y.value)?y.value:"",e=_.isDefined(y.value2)?y.value2:"",u!==""||e!==""){o.empty=!1;break}d.dialog.hide(i.dialog.search),i.table.pagination.page=1,i.do_request({pagination:i.table.pagination})}},on_view_click(a){d.dialog.show(i.dialog.view,{parentRow:i.parentRow,row:a.row,template:i.template,replica:i.replica,definition:i.definition})},on_edit_click(a){d.dialog.show(i.dialog.edit,{parentRow:i.parentRow,row:a.row,template:i.template,replica:i.replica,definition:i.definition,index:a.rowIndex,relations:i.relations})},on_add_click(){d.dialog.show(i.dialog.edit,{parentRow:i.parentRow,template:i.template,replica:i.replica,definition:i.definition,relations:i.relations})},on_close_dialog_edit(a){let o=a.row;if(o)if(a.is_edit)if(_.isDefined(o._pk_))i.table.rows[a.index]=o;else{d.dialog.hide(i.dialog.edit),setTimeout(function(){d.dialog.show(i.dialog.edit,{row:o,parentRow:i.parentRow,template:i.template,replica:i.replica,definition:i.definition,relations:i.relations})},100);return}else i.do_request({pagination:i.table.pagination});d.dialog.hide(i.dialog.edit)},on_page_changed(){let a=+i.table.pagination.page;!isNaN(a)&&a>0&&i.do_request({pagination:i.table.pagination})}}},$={class:"q-ml-sm"},ee={class:"full-width row flex-center text-accent q-gutter-sm"},ie={class:"text-subtitle2"},le={key:0,class:"text-left"},ae={class:"text-caption"};function oe(a,o,u,e,y,m){const U=x("Search"),E=x("View2"),I=x("Edit2");return s(),q(j,null,[n(B,{class:"background-layout",style:C("min-width: 60vw; max-width: 90vw;"+e.dialog.main.style)},{default:t(()=>[Q((s(),c(V,{class:"q-pa-none header-main",style:C(e.APP?.color?.header?"background: "+e.APP.color.header+" !important;":"")},{default:t(()=>[n(F,{class:"q-pr-none"},{default:t(()=>[n(S,null,{default:t(()=>[n(Y,{class:"text-h6 text-white"},{default:t(()=>[R(w(e.template.title+" - "+e.definition.title),1)]),_:1})]),_:1}),n(S,{side:""},{default:t(()=>[n(g,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close",onClick:m.on_close_click},{default:t(()=>[n(Z,null,{default:t(()=>[R(w(a.$t("label.close")),1)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["style"])),[[D,e.dialog.main.onDrag,void 0,{mouse:!0}]]),e.labels?.length?(s(),c(V,{key:0,class:"q-pa-sm q-mt-xs"},{default:t(()=>[(s(!0),q(j,null,A(e.labels,(l,f)=>(s(),c(H,{key:f,color:e.chips[f%e.chips.length],"text-color":"white",class:"ellipsis-text"},{default:t(()=>[h("strong",null,[h("span",null,w(l.title)+":",1)]),h("span",$,w(l.value),1)]),_:2},1032,["color"]))),128))]),_:1})):b("",!0),n(V,{style:{"max-height":"80vh","overflow-y":"scroll !important"},class:"q-pa-xs"},{default:t(()=>[n(W,{class:"table-sticky-header q-ma-sm",rows:e.table.rows,columns:e.table.columns,"visible-columns":e.table.visibles,"row-key":"_pk_",loading:e.table.loading,selection:e.util.isObject(e.definition.table)?e.definition.table.selection:"single",selected:e.table.selected,"onUpdate:selected":o[1]||(o[1]=l=>e.table.selected=l),pagination:e.table.pagination,"onUpdate:pagination":o[2]||(o[2]=l=>e.table.pagination=l),dense:a.$q.screen.lt.md,"no-data-label":a.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":l=>{},"rows-per-page-options":e.util.isObject(e.definition.table)&&e.definition.table.page?.options?e.definition.table.page.options:[10,20,30],onRequest:m.do_request,"binary-state-sort":"",separator:e.util.isObject(e.definition.table)?e.definition.table.separator:"cell",bordered:"",style:{"max-height":"72vh"}},{top:t(()=>[e.util.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.fxGrid.permission.deletes(e.permission)&&!e.onlyView?(s(),c(g,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"negative",icon:"delete",disable:!e.table.selected.length,loading:e.table.deleting,onClick:m.on_delete_click},null,8,["disable","loading","onClick"])):b("",!0),e.fxGrid.permission.add(e.permission)&&!e.onlyView?(s(),c(g,{key:1,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"teal",icon:"add",onClick:m.on_add_click},null,8,["onClick"])):b("",!0),n(J),e.search.filters?.length?(s(),c(g,{key:2,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:m.on_search_click},{default:t(()=>[e.search.empty?b("",!0):(s(),c(K,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):b("",!0),n(g,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:e.table.loading,onClick:m.on_refresh_click},null,8,["loading","onClick"])]),"no-data":t(({message:l})=>[h("div",ee,[n(G,{size:"2em",name:"block"}),h("span",ie,w(l),1)])]),loading:t(()=>[n(M,{showing:"",color:"primary"})]),"header-selection":t(l=>[e.util.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.fxGrid.permission.deletes(e.permission)&&!e.onlyView?(s(),q("div",le,[n(O,{dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:l.selected,"onUpdate:modelValue":f=>l.selected=f},null,8,["modelValue","onUpdate:modelValue"])])):b("",!0)]),"body-selection":t(l=>[e.util.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.fxGrid.permission.deletes(e.permission)&&!e.onlyView?(s(),c(O,{key:0,dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:l.selected,"onUpdate:modelValue":f=>l.selected=f},null,8,["modelValue","onUpdate:modelValue"])):e.util.isObject(e.definition.table)&&e.fxGrid.permission.delete(e.permission)&&!e.onlyView?(s(),c(g,{key:1,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"negative",icon:"delete",onClick:f=>m.on_delete_click(l)},null,8,["onClick"])):b("",!0),e.fxGrid.permission.edit(e.permission)&&!e.onlyView?(s(),c(g,{key:2,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"primary",icon:"drive_file_rename_outline",onClick:f=>m.on_edit_click(l)},null,8,["onClick"])):b("",!0),e.fxGrid.permission.view(e.permission)?(s(),c(g,{key:3,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"deep-purple",icon:"visibility",onClick:f=>m.on_view_click(l)},null,8,["onClick"])):b("",!0)]),pagination:t(l=>[l.pagesNumber>2?(s(),c(g,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:l.isFirstPage,onClick:l.firstPage},null,8,["disable","onClick"])):b("",!0),n(g,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:l.isFirstPage,onClick:l.prevPage},null,8,["disable","onClick"]),n(N,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:e.table.pagination.page,"onUpdate:modelValue":[o[0]||(o[0]=f=>e.table.pagination.page=f),m.on_page_changed]},L({_:2},[e.util.isObject(e.definition.table)&&e.util.isObject(e.definition.table.page)&&e.definition.table.page.count===!0?{name:"append",fn:t(()=>[h("span",ae," / "+w(l.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),n(g,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:l.isLastPage,onClick:l.nextPage},null,8,["disable","onClick"]),l.pagesNumber>2?(s(),c(g,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:l.isLastPage,onClick:l.lastPage},null,8,["disable","onClick"])):b("",!0)]),_:1},8,["rows","columns","visible-columns","loading","selection","selected","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1})]),_:1},8,["style"]),n(P,{modelValue:e.dialog.search.show,"onUpdate:modelValue":o[3]||(o[3]=l=>e.dialog.search.show=l),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:t(()=>[Q(n(U,{parameters:e.dialog.search.parameters,onClose:m.on_close_dialog_search,style:C(e.dialog.search.style)},null,8,["parameters","onClose","style"]),[[D,e.dialog.search.onDrag,void 0,{mouse:!0}]])]),_:1},8,["modelValue"]),n(P,{modelValue:e.dialog.view.show,"onUpdate:modelValue":o[4]||(o[4]=l=>e.dialog.view.show=l),"transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:t(()=>[n(E,{parameters:e.dialog.view.parameters},null,8,["parameters"])]),_:1},8,["modelValue"]),n(P,{modelValue:e.dialog.edit.show,"onUpdate:modelValue":o[5]||(o[5]=l=>e.dialog.edit.show=l),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:t(()=>[n(I,{parameters:e.dialog.edit.parameters,onClose:m.on_close_dialog_edit},null,8,["parameters","onClose"])]),_:1},8,["modelValue"])],64)}const be=T(X,[["render",oe]]);export{be as default};
