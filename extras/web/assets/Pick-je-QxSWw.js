const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-BM65YuFT.js","assets/format-BYB7LI8Y.js","assets/index-3Ds9K3sY.js","assets/index-DH4Oj3ZA.css","assets/QTooltip-DTsmNrTK.js","assets/QTabPanels-Dth9Sind.js","assets/QResizeObserver-BXkVA_nK.js","assets/QSelect-ybIcc9Im.js","assets/touch-BjYP5sR0.js","assets/QPopupProxy-C3yyw3d7.js","assets/TouchPan-CDLsl8kT.js","assets/QForm-DrU6uDMp.js","assets/ClosePopup-Cf-fI5V5.js"])))=>i.map(i=>d[i]);
import{_ as C,ai as Q,an as V,Y as b,r as d,a2 as P,a3 as p,aa as S,f as t,a4 as i,al as k,a6 as y,a7 as f,B as w,a1 as g,a5 as r,a8 as u,aj as m,E as j,bt as N,ah as B,at as I,Q as U,aI as R,am as D,ak as z,F as L}from"./index-3Ds9K3sY.js";import{Q as O,b as v,a as A}from"./format-BYB7LI8Y.js";import{Q as E}from"./QTooltip-DTsmNrTK.js";import{Q as F}from"./QSpace-CAwOBfmg.js";import{Q as T,a as Y}from"./QTable-B2WsSpTs.js";import{Q as G}from"./QInnerLoading-7DJ72R4W.js";import{C as x}from"./ClosePopup-Cf-fI5V5.js";import{g as n}from"./Index-DuSzNtU_.js";import"./QList-CSjzfvcx.js";import"./QSelect-ybIcc9Im.js";const H={props:["parameters"],emits:["close"],components:{Search:Q(()=>V(()=>import("./Search-BM65YuFT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])))},setup(){return{util:b,template:d({}),field:d({}),pick:d({}),relations:d([]),replica:d(null),table:d({rows:[],columns:[],visibles:[],selected:null,pagination:{},loading:!1}),search:d({filters:[],empty:!0}),dialog:d({search:{show:!1,parameters:null}})}},created(){let e=this,a=n.get.object(e.parameters);e.template=n.get.object(a.template),e.replica=n.get.number(a.replica,null),e.field=n.get.object(a.field),e.relations=n.get.array(a.relations),e.pick=n.get.object(a.pick),e.pick._grid_id_=e.template._grid_id_,e.search={empty:!0,filters:n.copy(n.get.array(e.pick.table.filters))},e.table={rows:[],columns:e.pick.table.columns,visibles:e.pick.table.visibles,selected:null,pagination:{page:1,rowsPerPage:e.pick.table.page.default,sortBy:e.pick.table.order.field,descending:e.pick.table.order.descending===!0},loading:!1},e.do_request({pagination:e.table.pagination})},methods:{do_request(e){let a=this,c=null;a.template.allUseSameReplica===!0&&(c=a.replica),n.action.page({props:e,table:a.table,search:a.search,definition:a.pick,relations:a.relations,replica:c,allUseSameReplica:a.template.allUseSameReplica})},on_refresh_click(){let e=this;e.do_request({pagination:e.table.pagination})},on_select_click(){let e=this;e.$emit("close",e.table.selected)},on_search_click(){let e=this,a=e.dialog.search;a.parameters={filters:n.copy(e.search.filters),template:e.template},a.show=!0},on_close_dialog_search(e){let a=this;if(b.isArray(e)){let c=a.search,l,_;c.filters=e,c.empty=!0;for(const o of c.filters)if(l=b.isDefined(o.value)?o.value:"",_=b.isDefined(o.value2)?o.value2:"",l!==""||_!==""){c.empty=!1;break}a.dialog.search={show:!1,parameters:null},a.table.pagination.page=1,a.do_request({pagination:a.table.pagination})}},on_page_changed(){let e=this,a=+e.table.pagination.page;!isNaN(a)&&a>0&&e.do_request({pagination:e.table.pagination})}}},J={class:"full-width row flex-center text-accent q-gutter-sm"},K={class:"text-subtitle2"},M={class:"text-caption"},W={class:"col-6 q-pr-xs text-left"},X={class:"col-6 q-pl-xs text-right"};function Z(e,a,c,l,_,o){const q=P("Search");return p(),S(L,null,[t(D,{style:{"min-width":"60vw","max-width":"90vw","max-height":"90vh"}},{default:i(()=>[t(k,{class:"q-pa-none header-main"},{default:i(()=>[t(O,{class:"q-pr-none"},{default:i(()=>[t(v,null,{default:i(()=>[t(A,{class:"text-h6 text-white"},{default:i(()=>[y(f(l.pick.title),1)]),_:1})]),_:1}),t(v,{side:""},{default:i(()=>[w((p(),g(r,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close"},{default:i(()=>[t(E,null,{default:i(()=>[y(f(e.$t("label.close")),1)]),_:1})]),_:1})),[[x]])]),_:1})]),_:1})]),_:1}),t(k,{style:{"max-height":"80vh"},class:"q-pa-xs q-pt-sm scroll"},{default:i(()=>[t(T,{class:"table-sticky-header q-ma-none",rows:l.table.rows,columns:l.table.columns,"visible-columns":l.table.visibles,"row-key":"_pk_",loading:l.table.loading,selection:"single",pagination:l.table.pagination,"onUpdate:pagination":a[2]||(a[2]=s=>l.table.pagination=s),dense:e.$q.screen.lt.md,"no-data-label":e.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":s=>{},"rows-per-page-options":l.util.isObject(l.pick.table)&&l.pick.table.page?.options?l.pick.table.page.options:[10,20,30],onRequest:o.do_request,"binary-state-sort":"",separator:l.util.isObject(l.pick.table)?l.pick.table.separator:"cell",bordered:"",style:{"max-height":"70vh"}},{top:i(()=>[t(F),l.search.filters&&l.search.filters.length?(p(),g(r,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:o.on_search_click},{default:i(()=>[l.search.empty?u("",!0):(p(),g(Y,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):u("",!0),t(r,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:l.table.loading,onClick:o.on_refresh_click},null,8,["loading","onClick"])]),"no-data":i(({message:s})=>[m("div",J,[t(j,{size:"2em",name:"block"}),m("span",K,f(s),1)])]),loading:i(()=>[t(G,{showing:"",color:"primary"})]),"body-selection":i(s=>[t(N,{modelValue:l.table.selected,"onUpdate:modelValue":a[0]||(a[0]=h=>l.table.selected=h),val:s.row,color:"primary"},null,8,["modelValue","val"])]),pagination:i(s=>[s.pagesNumber>2?(p(),g(r,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:s.isFirstPage,onClick:s.firstPage},null,8,["disable","onClick"])):u("",!0),t(r,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:s.isFirstPage,onClick:s.prevPage},null,8,["disable","onClick"]),t(B,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:l.table.pagination.page,"onUpdate:modelValue":[a[1]||(a[1]=h=>l.table.pagination.page=h),o.on_page_changed]},I({_:2},[l.util.isObject(l.pick.table)&&l.util.isObject(l.pick.table.page)&&l.pick.table.page.count===!0?{name:"append",fn:i(()=>[m("span",M," / "+f(s.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),t(r,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:s.isLastPage,onClick:s.nextPage},null,8,["disable","onClick"]),s.pagesNumber>2?(p(),g(r,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:s.isLastPage,onClick:s.lastPage},null,8,["disable","onClick"])):u("",!0)]),_:1},8,["rows","columns","visible-columns","loading","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1}),t(U),t(R,{class:"row"},{default:i(()=>[m("div",W,[w(t(r,{label:e.$t("label.cancel"),color:"negative","no-caps":"",glossy:""},null,8,["label"]),[[x]])]),m("div",X,[t(r,{label:e.$t("label.select"),color:"indigo","no-caps":"",glossy:"",disable:!l.table.selected?._pk_,onClick:o.on_select_click},null,8,["label","disable","onClick"])])]),_:1})]),_:1}),t(z,{modelValue:l.dialog.search.show,"onUpdate:modelValue":a[3]||(a[3]=s=>l.dialog.search.show=s),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(2px)"},{default:i(()=>[t(q,{parameters:l.dialog.search.parameters,onClose:o.on_close_dialog_search},null,8,["parameters","onClose"])]),_:1},8,["modelValue"])],64)}const ce=C(H,[["render",Z]]);export{ce as default};
