const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Pick-je-QxSWw.js","assets/index-3Ds9K3sY.js","assets/index-DH4Oj3ZA.css","assets/format-BYB7LI8Y.js","assets/QTooltip-DTsmNrTK.js","assets/QSpace-CAwOBfmg.js","assets/QTable-B2WsSpTs.js","assets/QList-CSjzfvcx.js","assets/QSelect-ybIcc9Im.js","assets/QInnerLoading-7DJ72R4W.js","assets/ClosePopup-Cf-fI5V5.js","assets/Index-DuSzNtU_.js"])))=>i.map(i=>d[i]);
import{_ as E,ai as I,an as $,r as m,Y as _,$ as D,a2 as O,a3 as r,aa as x,f as t,a4 as o,al as U,a6 as k,a7 as y,B as V,a1 as p,a5 as v,aj as b,F as q,ab as A,ah as h,E as N,a8 as f,Q as w,at as L,aI as z,bo as R,am as Y,ak as G}from"./index-3Ds9K3sY.js";import{Q as H,b as C,a as J}from"./format-BYB7LI8Y.js";import{Q}from"./QTooltip-DTsmNrTK.js";import{Q as j}from"./QSelect-ybIcc9Im.js";import{Q as K,a as P,b as M,c as S}from"./QTabPanels-Dth9Sind.js";import{Q as W,a as X,b as Z}from"./QPopupProxy-C3yyw3d7.js";import{Q as ee,a as F}from"./QFab-xgpS96yX.js";import{C as g}from"./ClosePopup-Cf-fI5V5.js";import{g as u}from"./Index-DuSzNtU_.js";import"./QResizeObserver-BXkVA_nK.js";import"./touch-BjYP5sR0.js";import"./TouchPan-CDLsl8kT.js";import"./QSpace-CAwOBfmg.js";import"./QTable-B2WsSpTs.js";import"./QList-CSjzfvcx.js";import"./QInnerLoading-7DJ72R4W.js";const ae={props:["parameters"],emits:["close"],components:{Pick:I(()=>$(()=>import("./Pick-je-QxSWw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])))},setup(){return{id:m(null),title:m(""),is_edit:m(!1),saving:m(!1),index:m(null),fields:m(null),form:m(null),template:m({options:{},enums:{}}),replica:m(null),relations:m([]),enums:m({}),options:m({}),row:m(null),dialog:m({pick:{show:!1,parameters:null}})}},created(){let e=this,n=u.get.object(e.parameters),d=u.get.object(n.form);e.template=u.get.object(n.template),e.replica=u.get.object(n.replica),e.relations=u.get.array(n.relations),e.enums={},_.isObject(e.template.enums)&&Object.keys(e.template.enums).forEach(c=>{e.enums[c]=[null].concat(e.template.enums[c])}),e.options={},_.isObject(e.template.options)&&Object.keys(e.template.options).forEach(c=>{e.options[c]=[null].concat(e.template.options[c])}),e.data=u.get.object(n.data),e.form=d,e.fields=[],e.is_edit=n.is_edit,e.title=(_.isString(d.title)&&d.title!==""?d.title+" - ":"")+(e.is_edit?e.$t("label.edit"):e.$t("label.new"));let i=u.get.array(d.fields);if(e.is_edit){e.id=u.id.fromPk(e.form.id,e.data._pk_);for(const c of i){let l=u.clone.field(c);l.value=_.getFieldValue(l.name,e.data),l.type==="datetime"&&l.converter==="epoch"?l.value=_.format.date(l.value,{format:l.pattern||null}):l.type==="pick"?_.isDefined(l.value)&&(l.text=_.isFunction(l.format)?l.format(l.value,n.row):l.value+""):_.isFunction(l.format)&&(l.text=l.format(l.value,n.row)),(l.insertable===!0||l.editable===!0)&&e.fields.push(l)}}else for(const c of i)if(c.insertable){let l=u.clone.field(c);l.editable=!0,e.fields.push(l)}},methods:{on_pick_select_click(e){let n=this,d=n.template.picks[e.pick];if(!_.isObject(d)){D.error("error.required","label.pick");return}n.dialog.pick={show:!0,parameters:{template:n.template,field:e,pick:d,replica:n.replica}}},on_pick_remove_click(e){e.value=void 0,e.text=void 0},on_close_dialog_pick(e){let n=this;if(e?._pk_){let d=n.dialog.pick.parameters.field,i=_.isFunction(d.format)?d.format(e):e+"";d.value=e,d.text=i}n.dialog.pick={show:!1,parameters:null,field:null}},on_save_click(){let e=this;e.form._grid_id_=e.template._grid_id_,u.action.save({id:e.id,fields:e.fields,definition:e.form,replica:e.replica,relations:e.relations,is_edit:e.is_edit,saving:e.saving,onSuccess:function(n){e.$emit("close",{row:n,is_edit:e.is_edit,index:e.index})}})},on_before_show_calendar(e){e.proxy_value=e.value,e.tab=e.type==="time"?"time":"date"}}},le={class:"row"},te={class:"bg-primary"},oe={class:"q-pa-xs bg-white row"},se={class:"col-6 text-left"},ne={class:"col-6 text-right"},ie={class:"col-6 q-pr-xs text-left"},re={class:"col-6 q-pl-xs text-right"};function de(e,n,d,i,c,l){const B=O("Pick");return r(),x(q,null,[t(Y,{style:R("width: "+(e.$q.screen.lt.md?"100%;":"50%;"))},{default:o(()=>[t(U,{class:"q-pa-none header-main"},{default:o(()=>[t(H,{class:"q-pr-none"},{default:o(()=>[t(C,null,{default:o(()=>[t(J,{class:"text-h6 text-white"},{default:o(()=>[k(y(i.title),1)]),_:1})]),_:1}),t(C,{side:""},{default:o(()=>[V((r(),p(v,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close",disable:i.saving},{default:o(()=>[t(Q,null,{default:o(()=>[k(y(e.$t("label.close")),1)]),_:1})]),_:1},8,["disable"])),[[g]])]),_:1})]),_:1})]),_:1}),t(U,{style:{"max-height":"80vh"},class:"q-pa-xs q-mt-xs scroll"},{default:o(()=>[b("div",le,[(r(!0),x(q,null,A(i.fields,(a,T)=>(r(),x("div",{key:T,class:"col-md-6 col-sm-12 q-mb-xs",style:{width:"100%"}},[a.type==="words"?(r(),p(h,{key:0,type:"text",label:a.label,readonly:!a.editable,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,filled:"",autogrow:"",style:{"max-height":"200px",overflow:"scroll"}},null,8,["label","readonly","modelValue","onUpdate:modelValue"])):a.type==="enum"?(r(),p(j,{key:1,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,label:a.label,readonly:a.editable!==!0,options:i.enums[a.enum],"option-value":"value","option-label":"label","emit-value":"","map-options":"",filled:""},null,8,["modelValue","onUpdate:modelValue","label","readonly","options"])):a.type==="option"?(r(),p(j,{key:2,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,label:a.label,readonly:a.editable!==!0,options:i.options[a.option],"option-value":"value","option-label":"label","emit-value":"","map-options":"",filled:""},null,8,["modelValue","onUpdate:modelValue","label","readonly","options"])):a.type==="datetime"||a.type==="date"||a.type==="time"?(r(),p(h,{key:3,type:"text",label:a.label,readonly:!a.editable,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,filled:""},{append:o(()=>[t(N,{name:a.type==="time"?"schedule":a.type==="date"?"calendar_month":"event",class:"cursor-pointer"},{default:o(()=>[t(W,{"transition-show":"scale","transition-hide":"scale",cover:"",onBeforeShow:s=>l.on_before_show_calendar(a)},{default:o(()=>[b("div",te,[t(K,{modelValue:a.tab,"onUpdate:modelValue":s=>a.tab=s,class:"bg-primary text-grey-5 shadow-2 text-subtitle2",align:"justify","no-caps":"","indicator-color":"transparent","active-color":"white"},{default:o(()=>[a.type==="datetime"||a.type==="date"?(r(),p(P,{key:0,name:"date"},{default:o(()=>[b("span",null,y(e.$t("label.date")),1)]),_:1})):f("",!0),a.type==="datetime"||a.type==="time"?(r(),p(P,{key:1,name:"time"},{default:o(()=>[b("span",null,y(e.$t("label.time")),1)]),_:1})):f("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(w),t(M,{modelValue:a.tab,"onUpdate:modelValue":s=>a.tab=s},{default:o(()=>[a.type==="datetime"||a.type==="date"?(r(),p(S,{key:0,name:"date",class:"q-pa-none"},{default:o(()=>[t(X,{modelValue:a.proxy_value,"onUpdate:modelValue":s=>a.proxy_value=s,mask:a.format,square:""},null,8,["modelValue","onUpdate:modelValue","mask"])]),_:2},1024)):f("",!0),a.type==="datetime"||a.type==="time"?(r(),p(S,{key:1,name:"time",class:"q-pa-none"},{default:o(()=>[t(Z,{modelValue:a.proxy_value,"onUpdate:modelValue":s=>a.proxy_value=s,mask:a.format,format24h:"",square:""},null,8,["modelValue","onUpdate:modelValue","mask"])]),_:2},1024)):f("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(w),b("div",oe,[b("div",se,[V(t(v,{label:e.$t("label.cancel"),color:"negative","no-caps":""},null,8,["label"]),[[g]])]),b("div",ne,[V(t(v,{label:e.$t("label.ok"),color:"secondary","no-caps":"",onClick:s=>a.value=a.proxy_value},null,8,["label","onClick"]),[[g]])])])])]),_:2},1032,["onBeforeShow"])]),_:2},1032,["name"])]),_:2},1032,["label","readonly","modelValue","onUpdate:modelValue"])):a.type==="pick"?(r(),p(h,{key:4,type:"text",label:a.label,readonly:!a.editable,modelValue:a.text,"onUpdate:modelValue":s=>a.text=s,filled:""},L({_:2},[a.editable?{name:"append",fn:o(()=>[t(ee,{modelValue:a.fab,"onUpdate:modelValue":s=>a.fab=s,icon:"flaky",direction:"left",padding:"none",flat:"",class:"q-ma-none q-pa-none"},{default:o(()=>[t(F,{color:"secondary",icon:"fact_check",onClick:s=>l.on_pick_select_click(a)},{default:o(()=>[t(Q,null,{default:o(()=>[k(y(e.$t("label.select")),1)]),_:1})]),_:2},1032,["onClick"]),a.value?(r(),p(F,{key:0,color:"negative",icon:"delete_forever",onClick:s=>l.on_pick_remove_click(a)},{default:o(()=>[t(Q,null,{default:o(()=>[k(y(e.$t("label.delete")),1)]),_:1})]),_:2},1032,["onClick"])):f("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),key:"0"}:void 0]),1032,["label","readonly","modelValue","onUpdate:modelValue"])):(r(),p(h,{key:5,type:a.type,label:a.label,readonly:!a.editable,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,filled:""},null,8,["type","label","readonly","modelValue","onUpdate:modelValue"]))]))),128))])]),_:1}),t(w),t(z,{class:"row"},{default:o(()=>[b("div",ie,[V(t(v,{label:e.$t("label.cancel"),color:"negative","no-caps":"",glossy:"",disable:i.saving},null,8,["label","disable"]),[[g]])]),b("div",re,[t(v,{label:e.$t("label.save"),color:"secondary","no-caps":"",glossy:"",loading:i.saving,onClick:l.on_save_click},null,8,["label","loading","onClick"])])]),_:1})]),_:1},8,["style"]),t(G,{modelValue:i.dialog.pick.show,"onUpdate:modelValue":n[0]||(n[0]=a=>i.dialog.pick.show=a),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(2px)"},{default:o(()=>[t(B,{parameters:i.dialog.pick.parameters,onClose:l.on_close_dialog_pick},null,8,["parameters","onClose"])]),_:1},8,["modelValue"])],64)}const Ue=E(ae,[["render",de]]);export{Ue as default};
